<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jenkins Plugin插件開發入門 | JunHong's Blog</title><meta name="keywords" content="CI/CD,jenkins,jenkins plugin"><meta name="author" content="JunHong"><meta name="copyright" content="JunHong"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言DevOps是一種軟體開發方法論，旨在加速軟體生命週期，從設計到交付，並透過持續集成、持續交付、持續監控來提高軟體質量。透過持續集成和持續交付實現快速、可靠地將軟體部署到生產環境。 而Jenkins 是一種用於自動化構建和測試的軟件工具。它通常用於持續集成和持續交付流程中，可以自動執行程序構建、測試和部署任務。使用 Jenkins 可以減少人為干預，提高應用程序的品質和可用性。它還可以通過監控"><meta property="og:type" content="article"><meta property="og:title" content="Jenkins Plugin插件開發入門"><meta property="og:url" content="https://sp12893678.net/posts/Jenkins%20Plugin%E6%8F%92%E4%BB%B6%E9%96%8B%E7%99%BC%E5%85%A5%E9%96%80/index.html"><meta property="og:site_name" content="JunHong&#39;s Blog"><meta property="og:description" content="前言DevOps是一種軟體開發方法論，旨在加速軟體生命週期，從設計到交付，並透過持續集成、持續交付、持續監控來提高軟體質量。透過持續集成和持續交付實現快速、可靠地將軟體部署到生產環境。 而Jenkins 是一種用於自動化構建和測試的軟件工具。它通常用於持續集成和持續交付流程中，可以自動執行程序構建、測試和部署任務。使用 Jenkins 可以減少人為干預，提高應用程序的品質和可用性。它還可以通過監控"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_jenkins-plugin.png"><meta property="article:published_time" content="2022-12-18T04:00:00.000Z"><meta property="article:modified_time" content="2025-06-16T11:53:15.192Z"><meta property="article:author" content="JunHong"><meta property="article:tag" content="CI&#x2F;CD"><meta property="article:tag" content="jenkins"><meta property="article:tag" content="jenkins plugin"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_jenkins-plugin.png"><link rel="shortcut icon" href="/img/logo/icon-128x128.png"><link rel="canonical" href="https://sp12893678.net/posts/Jenkins%20Plugin%E6%8F%92%E4%BB%B6%E9%96%8B%E7%99%BC%E5%85%A5%E9%96%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/img/logo/icon-72x72.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/logo/icon-72x72.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/logo/icon-72x72.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-8883435840385596",enable_page_level_ads:"true"})</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-182309718-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-182309718-1")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查詢的內容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300},copy:{success:"複製成功",error:"複製錯誤",noSupport:"瀏覽器不支援"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"剛剛",min:"分鐘前",hour:"小時前",day:"天前",month:"個月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isanchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Jenkins Plugin插件開發入門",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-06-16 19:53:15"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));GLOBAL_CONFIG_SITE.isHome&&/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/tag-diy.css"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8883435840385596" crossorigin="anonymous"></script><style>.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">標籤</div><div class="length-num">34</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分類</div><div class="length-num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>目錄</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分類</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_jenkins-plugin.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">JunHong's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜尋</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>目錄</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分類</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Jenkins Plugin插件開發入門</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2022-12-18T04:00:00.000Z" title="發表於 2022-12-18 12:00:00">2022-12-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2025-06-16T11:53:15.192Z" title="更新於 2025-06-16 19:53:15">2025-06-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/DevOps/">DevOps</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字數總計:</span><span class="word-count">4.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">閱讀時長:</span><span>18分鐘</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Jenkins Plugin插件開發入門"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">閱讀量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>DevOps是一種軟體開發方法論，旨在加速軟體生命週期，從設計到交付，並透過持續集成、持續交付、持續監控來提高軟體質量。透過持續集成和持續交付實現快速、可靠地將軟體部署到生產環境。</p><p>而Jenkins 是一種用於自動化構建和測試的軟件工具。它通常用於持續集成和持續交付流程中，可以自動執行程序構建、測試和部署任務。使用 Jenkins 可以減少人為干預，提高應用程序的品質和可用性。它還可以通過監控項目的構建狀態，提供即時反饋和報告。</p><p>Jenkins提供Jenkins Plugin的方式使開發者可以開發需要的程式以擴充至建置流程中，滿足團隊專案在持續整合期間的需求。</p><div class="note info flat"><p>由於當初在找Jenkins Plugin教學時，發現官方資料非常稀少，後來得知官方教學的網域有改，之前的文章都無法Acess了<br>像遇到此種情況，當時很機靈的拿去網站時光機試試看，沒想到還真有資料。不過網站時光機訪問時有些緩慢就是了，這是一個小缺點</p></div><h2 id="實作重點"><a href="#實作重點" class="headerlink" title="實作重點"></a>實作重點</h2><ul><li>環境準備<ul><li>安裝Java JDK 8</li><li>安裝Maven</li><li>設定環境變數</li></ul></li><li>使用插件範本建立專案、測試運行與發佈打包<ul><li>使用樣本插件原型建立專案結構</li><li>確認可以建構專案</li><li>運行插件</li><li>在Jenkins上測試範本插件</li><li>發佈打包插件</li></ul></li><li>Plugin結構與Java與Jelly的關聯說明<ul><li>空白插件專案結構</li><li>Jenkins 通過固定的命名方式，來確定對應的檔案</li><li>撰寫java與jelly溝通變數(物件帶有Descriptors)</li></ul></li><li>Jenkins BuildStep功能<ul><li>表單驗證機制</li><li>撰寫執行內容 &amp; 取得Workspace(讀檔、寫檔)</li></ul></li><li>了解Jelly Tags<ul><li>Jelly namespace</li><li>一般文字(國際化與在地化)</li><li>幫助說明(國際化與在地化)</li><li>預設數值(Default value)</li><li>Jelly 中使用變數資料</li><li>全域環境變數設置</li></ul></li><li>建置報告獨立頁面<ul><li>建立HelloWorldAction.java以實作RunAction2</li><li>獨立頁面UI設置</li><li>在Builder執行Action以觸發頁面生成</li></ul></li></ul><h2 id="環境準備"><a href="#環境準備" class="headerlink" title="環境準備"></a>環境準備</h2><h3 id="安裝Java-JDK-8"><a href="#安裝Java-JDK-8" class="headerlink" title="安裝Java JDK 8"></a>安裝Java JDK 8</h3><p>Jenkins是基於Java建構的，因此我們需要先安裝Java 開發套件(JDK)</p><div class="note info flat"><p>若有額外需求可查看Jenkins對各個Java版本支援：<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.jenkins.io/doc/administration/requirements/java/">https://www.jenkins.io/doc/administration/requirements/java/</a></p></div><h3 id="安裝Maven"><a href="#安裝Maven" class="headerlink" title="安裝Maven"></a>安裝Maven</h3><p>Jenkins插件主要使用Maven建置<br>版本注意，請確保提供最近版本的 Maven 3，最好是 3.3.9 或較新版本</p><h3 id="設定環境變數"><a href="#設定環境變數" class="headerlink" title="設定環境變數"></a>設定環境變數</h3><ol><li>PATH：<ol><li>C:\Program Files\Java\jdk1.8.0_202\bin</li><li>C:\apache-maven-3.8.3\bin</li></ol></li><li>JAVA_HOME：C:\Program Files\Java\jdk1.8.0_202</li></ol><h2 id="使用插件範本建立專案、測試運行與發佈打包"><a href="#使用插件範本建立專案、測試運行與發佈打包" class="headerlink" title="使用插件範本建立專案、測試運行與發佈打包"></a>使用插件範本建立專案、測試運行與發佈打包</h2><h3 id="使用樣本插件原型建立專案結構"><a href="#使用樣本插件原型建立專案結構" class="headerlink" title="使用樣本插件原型建立專案結構"></a>使用樣本插件原型建立專案結構</h3><p>在我們的workspace打開terminal執行以下指令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -U archetype:generate -Dfilter=<span class="string">&quot;io.jenkins.archetypes:&quot;</span></span><br></pre></td></tr></table></figure><p>透過上述指令會列出符合條件的幾個遠端repo讓我們選擇，接著可以選擇插件版本、artifactId等專案屬性</p><div class="note info flat"><p>💡 參數介紹<br><strong><code>-U,--update-snapshots</code> 強制檢查與遠端存儲庫的缺失版本和更新快照<br><code>archetype:generate</code> 從原型生成一個新的專案，如果使用部分原型，則更新當前專案。<br><code>-D,--define</code> 定義系統屬性<br><code>-filter</code> 設定過濾</strong></p></div><p><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/jenkins-plugin-1.png" alt="Untitled"></p><h3 id="確認可以建構專案"><a href="#確認可以建構專案" class="headerlink" title="確認可以建構專案"></a>確認可以建構專案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv demo demo-plugin </span><br><span class="line"><span class="built_in">cd</span> demo-plugin</span><br><span class="line">mvn verify</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 <code>verify</code> 驗證檔案package是否正確<br>在過程中會依照maven的生命週期依序執行，其中會下載許多的dependencies、分析測試，最後驗證，預期結果最後如下圖</p></div><h3 id="運行插件"><a href="#運行插件" class="headerlink" title="運行插件"></a>運行插件</h3><p><strong>maven-hpi-plugin</strong>幫我們處理建構和打包jenkins plugin，他還提供了便利的方式執行Jenkins instance(含有我們的插件)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn hpi:run</span><br></pre></td></tr></table></figure><p>當看到💡 <code>INFO: Jenkins is fully up and running</code>時表示Jenkins instance成功啟動後，我們就可以打開瀏覽器訪問<a target="_blank" rel="external nofollow noopener noreferrer" href="http://localhost:8080/jenkins/">http://localhost:8080/jenkins/</a> 立即測試插件</p><div class="note info flat"><p>💡 我們運行的Jenkins instance，jenkins_home則為專案目錄中的work資料夾，因此資料都保留於這</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn hpi:run -Djetty.port=<span class="number">8090</span> # 更改port</span><br><span class="line">mvn hpi:run -Dhpi.prefix=/jenkins # Context path (環境路徑)</span><br></pre></td></tr></table></figure></div><h4 id="關於測試時更改程式碼"><a href="#關於測試時更改程式碼" class="headerlink" title="關於測試時更改程式碼"></a>關於測試時更改程式碼</h4><p>根據你的更改，你可以在運行實例中(running instance)看到，而不用重啟整個Maven Process</p><ul><li><strong>Views</strong>：每當瀏覽器請求頁面時，都會重新編譯(re-compiled) Groovy/Jelly，因此只要重整瀏覽器中的頁面即可</li><li><strong>Java code</strong>：<ul><li>當你在debug時，只要不接觸<strong>method signature</strong>，JVM的熱插拔(HotSwap)功能將會幫我們重新載入程式碼</li><li>此外，我們可以在Maven Process中按”ENTER”鍵，將會重新載入Jenkins webapp。但通常最好是停止該Process並重新啟動</li></ul></li><li><strong>POM</strong>：如果更改 POM，則必須停止並重新啟動 Maven 才能看到更改</li></ul><h3 id="在Jenkins上測試範本插件"><a href="#在Jenkins上測試範本插件" class="headerlink" title="在Jenkins上測試範本插件"></a>在Jenkins上測試範本插件</h3><p>在範例中我們使用hello-world-plugin的範本，因此在專案設置的”建置”流程中可以新增”Say Hello world”選項，並且設置面板，如下圖<br><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/jenkins-plugin-2.png" alt="Untitled"></p><p>建置後畫面<br><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/jenkins-plugin-3.png" alt="Untitled"></p><h3 id="發佈打包插件"><a href="#發佈打包插件" class="headerlink" title="發佈打包插件"></a>發佈打包插件</h3><p>如果想要打包我們的插件，只要執行以下指令，該指令將會在target目錄下產生<code>*.hpi</code>檔案。</p><p>※其他用戶可以在Jenkins Web UI將此插件檔案上傳使用，或者將檔案放置在<code>$JENKINS_HOME/plugins</code>也可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn package</span><br></pre></td></tr></table></figure><h2 id="Plugin結構與Java與Jelly的關聯說明"><a href="#Plugin結構與Java與Jelly的關聯說明" class="headerlink" title="Plugin結構與Java與Jelly的關聯說明"></a>Plugin結構與Java與Jelly的關聯說明</h2><h3 id="空白插件專案結構"><a href="#空白插件專案結構" class="headerlink" title="空白插件專案結構"></a><strong>空白插件專案結構</strong></h3><ul><li><code>src/main/java</code> ：外掛的 Java 原始檔</li><li><code>src/main/resources</code> ：外掛的 Jelly 檔案(用於UI、Form)、config設定(國際化/在地化)</li><li><code>src/main/webapp</code> ：外掛的靜態資源，如圖片或 HTLM 等</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">├── .github <span class="comment"># 與貢獻至jenkins plugin中相關流程 </span></span><br><span class="line">├── .mvn <span class="comment"># 定義專案資訊</span></span><br><span class="line">│   ├── extensions.xml</span><br><span class="line">│   └── maven.config</span><br><span class="line">├── src</span><br><span class="line">│   ├── main</span><br><span class="line">│   │   ├── java </span><br><span class="line">│   │   │   └── io </span><br><span class="line">│   │   │       └── jenkins</span><br><span class="line">│   │   │           └── plugins</span><br><span class="line">│   │   └── resources </span><br><span class="line">│   │       └── index.jelly</span><br><span class="line">│   └── <span class="built_in">test</span> </span><br><span class="line">│       └── java </span><br><span class="line">│           └── io </span><br><span class="line">│               └── jenkins</span><br><span class="line">│                   └── plugins</span><br><span class="line">├── Jenkinsfile</span><br><span class="line">├── LICENSE.md</span><br><span class="line">├── pom.xml</span><br><span class="line">└── README.md</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Jenkins-通過固定的命名方式，來確定對應的檔案"><a href="#Jenkins-通過固定的命名方式，來確定對應的檔案" class="headerlink" title="Jenkins 通過固定的命名方式，來確定對應的檔案"></a><strong>Jenkins 通過固定的命名方式，來確定對應的檔案</strong></h3><p>Jenkins Plugin中的UI內容都由Jelly來處理，因此我們必須讓Plugin中的java檔與相對應jelly檔互動，在這裡Jenkins透過<strong>固定的命名方式處理，來確定對應的檔案</strong></p><p>在範例中有一個範例元件，也就是我們在前面建置選擇的Say hello world，該元件是由此<code>java\io\jenkins\plugins\sample\HelloWorldBuilder.java</code> 擴充的</p><p><code>HelloWorldBuilder.java</code>會撰寫使用的建置擴充點以及運行的相關程式邏輯</p><p>而若要撰寫UI方面的內容則需：</p><ol><li>那我們必須在<code>resources</code>目錄下建立相應的路徑的資料夾 <code>resources\io\jenkins\plugins\sample\HelloWorldBuilder</code></li><li>在該目錄下建立<code>config.jelly</code><ol><li><code>resources\io\jenkins\plugins\sample\HelloWorldBuilder\config.jelly</code></li></ol></li></ol><div class="note info flat"><p>💡 通常UI內容可以用來讓使用者輸入一些設定，例如路徑</p></div><h3 id="撰寫java與jelly溝通變數-物件帶有Descriptors"><a href="#撰寫java與jelly溝通變數-物件帶有Descriptors" class="headerlink" title="撰寫java與jelly溝通變數(物件帶有Descriptors)"></a>撰寫java與jelly溝通變數(物件帶有Descriptors)</h3><p>在上述我們了解檔案java與jelly對應檔案的規則，那其中的變數欄位如何配對呢?<br>在這裡我們將說明物件帶有Descriptors情況下，需要實作的內容</p><div class="note info flat"><p>💡 Descriptors是我們在Build steps中會需要使用到的<br>Descriptors在多個實例的某個擴展會被需要</p></div><ol><li>Java<ol><li>定義不可變類別(immutable class)</li><li>將 <code>@DataBoundConstructor</code> 放在constructor上，它將告訴 Jenkins 如何實例化它</li><li>為需要設定的欄位定義getters，或是將欄位設置為<code>public final</code> ，這樣將允許Jenkins讀取數值以填置設定頁面(連到jelly)</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> <span class="keyword">implements</span> <span class="title">SimpleBuildStep</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> useFrench;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DataBoundConstructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HelloWorldBuilder</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>Jelly<ol><li>撰寫Jelly片段程式碼(通常命名為 config.jelly)</li><li>@field為屬性的名稱(對應constructor parameter name)…這樣jenkins才知道要將資料map到該欄位</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?jelly escape-by-default=&#x27;true&#x27;?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">j:jelly</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:j</span>=<span class="string">&quot;jelly:core&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:st</span>=<span class="string">&quot;jelly:stapler&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:d</span>=<span class="string">&quot;jelly:define&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:l</span>=<span class="string">&quot;/lib/layout&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:t</span>=<span class="string">&quot;/lib/hudson&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:f</span>=<span class="string">&quot;/lib/form&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;$&#123;%Name&#125;&quot;</span> <span class="attr">field</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">f:textbox</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">f:entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">j:jelly</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="Jenkins-BuildStep功能"><a href="#Jenkins-BuildStep功能" class="headerlink" title="Jenkins BuildStep功能"></a>Jenkins BuildStep功能</h2><h3 id="表單驗證機制"><a href="#表單驗證機制" class="headerlink" title="表單驗證機制"></a><strong>表單驗證機制</strong></h3><p>若想要為我們的UI表單增加驗證功能也是可以的</p><p>在<code>HelloWorldBuilder.java</code>的descriptor中我們可以依照規則增加method，讓jenkins知道該欄位需要經過該method驗證</p><p><strong>規則：</strong>method名稱須為 <strong>doCheck”FieldName”</strong> ⇒ <code>doCheckName</code> 且回傳型態為FormValidation，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Symbol(&quot;greet&quot;)</span></span><br><span class="line"><span class="meta">@Extension</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">DescriptorImpl</span> <span class="keyword">extends</span> <span class="title">BuildStepDescriptor</span>&lt;<span class="title">Builder</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> FormValidation <span class="title">doCheckName</span><span class="params">(<span class="meta">@QueryParameter</span> String value, <span class="meta">@QueryParameter</span> <span class="keyword">boolean</span> useFrench)</span></span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (value.length() == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> FormValidation.error(Messages.HelloWorldBuilder_DescriptorImpl_errors_missingName());</span><br><span class="line">            <span class="keyword">if</span> (value.length() &lt; <span class="number">4</span>)</span><br><span class="line">                <span class="keyword">return</span> FormValidation.warning(Messages.HelloWorldBuilder_DescriptorImpl_warnings_tooShort());</span><br><span class="line">            <span class="keyword">if</span> (!useFrench &amp;&amp; value.matches(<span class="string">&quot;.*[éáàç].*&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> FormValidation.warning(Messages.HelloWorldBuilder_DescriptorImpl_warnings_reallyFrench());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> FormValidation.ok();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="FormValidation提供我們簡單易懂的功能："><a href="#FormValidation提供我們簡單易懂的功能：" class="headerlink" title="FormValidation提供我們簡單易懂的功能："></a>FormValidation提供我們簡單易懂的功能：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FormValidation.error(String message)</span><br><span class="line"></span><br><span class="line">FormValidation.warning(String message)</span><br><span class="line"></span><br><span class="line">FormValidation.ok()</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 我們還可以用@QueryParameter定義其他欄位的參數，如果我們這段method還需要其他參數，這將會非常有用<br><strong>使用方式：</strong>增加參數時，參數名稱為field名稱</p></div><div class="note warning flat"><p>💡 Jenkins使用Localizer生成Messages Class，能夠以類型安全的方式訪問Message資源。<br>所以src/main/resources/**/Messages.properties匹配的所以文件都會生成一個對應的Messages類別<br>因此程式碼中調用FormValidation.error()方法的參數內容就是如此取得<br>透過該方法可以獲取當地語系化的消息</p></div><h3 id="撰寫執行內容-amp-取得Workspace-讀檔、寫檔"><a href="#撰寫執行內容-amp-取得Workspace-讀檔、寫檔" class="headerlink" title="撰寫執行內容 &amp; 取得Workspace(讀檔、寫檔)"></a>撰寫執行內容 &amp; 取得Workspace(讀檔、寫檔)</h3><p>在Class 中我們 implements <code>jenkins.tasks.SimpleBuildStep</code> 這個Interface Class,<br>其中我們必須實作 <code>perform</code> 函式，該函式會為我們 “Run this step.” 在該步驟執行我們的plugin想做的事</p><div class="note info flat"><p>💡 <code>perform</code> 函式中有提供許多參數，<code>FilePath workspace</code> 可以讓我們取得Workspace的路徑，有了路徑後我們就能讀檔、寫檔啦<br><code>listener.getLogger().println()</code> 可以將內容在jenkins console面板印出<br><strong>以下程式碼實作讀檔、走訪目錄所有檔案、寫檔</strong></p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">(Run&lt;?, ?&gt; run, FilePath workspace, EnvVars env, Launcher launcher, TaskListener listener)</span> <span class="keyword">throws</span> InterruptedException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        listener.getLogger().println(<span class="string">&quot;workspace path:&quot;</span> + workspace.getRemote());</span><br><span class="line">        </span><br><span class="line">        String filePath = workspace.getRemote() + <span class="string">&quot;\\Triangle.java&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// read file and for loop print line</span></span><br><span class="line">        <span class="keyword">try</span> (Stream&lt;String&gt; stream = Files.lines(Paths.get(filePath))) &#123;</span><br><span class="line">        	stream.forEach(line -&gt; listener.getLogger().println(line));</span><br><span class="line">	    &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// walk for the directory all file </span></span><br><span class="line">        <span class="keyword">try</span> (Stream&lt;Path&gt; paths = Files.walk(Paths.get(workspace.getRemote()))) &#123;</span><br><span class="line">        	paths</span><br><span class="line">            .filter(Files::isRegularFile)</span><br><span class="line">            .forEach(item -&gt; listener.getLogger().println(item));</span><br><span class="line">        &#125; </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// write file</span></span><br><span class="line">        Path path = Paths.get(workspace.getRemote() + <span class="string">&quot;\\plugin-generate.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">boolean</span> doesFileExist = Files.exists(path, <span class="keyword">new</span> LinkOption[]&#123; LinkOption.NOFOLLOW_LINKS &#125;);</span><br><span class="line">        <span class="keyword">if</span>(!doesFileExist) &#123;</span><br><span class="line">        	listener.getLogger().println(<span class="string">&quot;before write file.&quot;</span>);</span><br><span class="line">            List&lt;String&gt; lines = Arrays.asList(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;jenkins&quot;</span>);</span><br><span class="line">            Files.write(Paths.get(workspace.getRemote() + <span class="string">&quot;\\plugin-generate.txt&quot;</span>), lines, StandardCharsets.UTF_8);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="了解Jelly-Tags"><a href="#了解Jelly-Tags" class="headerlink" title="了解Jelly Tags"></a>了解Jelly Tags</h2><p>jelly程式檔由許多不同的 jelly 標籤組成。Jenkins 主要是用 Jelly 來進行 UI 管理。而 Jelly UI 技術的主要原理是通過伺服器端的渲染引擎將 Jelly 定義好的 XML 檔案渲染成用戶端需要的 HTML，Javascript 和 Ajax 等。</p><h3 id="Jelly-namespace"><a href="#Jelly-namespace" class="headerlink" title="Jelly namespace"></a>Jelly namespace</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?jelly escape-by-default=&#x27;true&#x27;?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">j:jelly</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:j</span>=<span class="string">&quot;jelly:core&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:st</span>=<span class="string">&quot;jelly:stapler&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:d</span>=<span class="string">&quot;jelly:define&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:l</span>=<span class="string">&quot;/lib/layout&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:t</span>=<span class="string">&quot;/lib/hudson&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:f</span>=<span class="string">&quot;/lib/form&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;$&#123;%Name&#125;&quot;</span> <span class="attr">field</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">f:textbox</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">f:entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">f:advanced</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;$&#123;%French&#125;&quot;</span> <span class="attr">field</span>=<span class="string">&quot;useFrench&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">description</span>=<span class="string">&quot;$&#123;%FrenchDescr&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">f:checkbox</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">f:entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">f:advanced</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">j:jelly</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 上述標籤告訴我們可以找到指定 namespace 中的 <strong>jelly 文件來源</strong>和<strong>其他標籤的引入</strong><br>xmlns:<em>namespace_name</em>=”<em>where to find resources in that namespace</em>“</p></div><div class="note info flat"><p>💡 從上方範例可以看出 <code>f:entry f:textbox f:advanced f:checkbox</code> 都是由 <code>xmlns:f=&quot;/lib/form&quot;</code> 宣告來的<br>詳細可查看Jenkins中Jelly Tags的原始碼專案</p><div><a class="link-card" title="https://github.com/jenkinsci/jenkins/tree/master/core/src/main/resources/lib" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jenkinsci/jenkins/tree/master/core/src/main/resources/lib"><div class="left"><i class="fas fa-link"></i></div><div class="right"><p class="text">Jenkins中Jelly Tags的原始碼專案</p><p class="url">https://github.com/jenkinsci/jenkins/tree/master/core/src/main/resources/lib</p></div></a></div>有關完整taglib來源介紹 可以看此連結<div><a class="link-card" title="https://reports.jenkins.io/core-taglib/jelly-taglib-ref.html" target="_blank" rel="external nofollow noopener noreferrer" href="https://reports.jenkins.io/core-taglib/jelly-taglib-ref.html"><div class="left"><i class="fas fa-link"></i></div><div class="right"><p class="text">Jenkins - Jelly Taglib references</p><p class="url">https://reports.jenkins.io/core-taglib/jelly-taglib-ref.html</p></div></a></div></div><h3 id="一般文字-國際化與在地化"><a href="#一般文字-國際化與在地化" class="headerlink" title="一般文字(國際化與在地化)"></a>一般文字(國際化與在地化)</h3><p>在jenkins與jelly基本使用的文章中我們知道 欄位與變數 的關係。除欄位外，我們也會擁有一般文字(標題、敘述)需要撰寫在UI上</p><p>對此jenkins在jelly支援國際化與在地化，設定上方便簡單</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">下方jelly程式碼我們可以發現title處有個`$&#123;%Name&#125;` ，**$&#123;%...&#125;這個標記是指定stapler要尋找在地化資源(localized resources)**，找不到就print 該文字</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;$&#123;%Name&#125;&quot;</span> <span class="attr">field</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">f:textbox</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">f:entry</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>關於在地化資源要在哪裡設定?</strong></p><p>在與<code>config.jelly</code>同一個目錄下新增<code>config.properties</code> ，設定方式非常簡易(<code>key=value</code>)</p><p><code>config.properties</code>為基本預設，若要新增其他語系可以新增<code>config_zone.properties</code> (ex. <code>config_zh_CN.properties</code>)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Name=Name123</span><br><span class="line">French=French</span><br><span class="line">FrenchDescr=Check if we should say hello in French</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/jenkins-plugin-4.png" alt="Untitled"></p><h3 id="幫助說明-國際化與在地化"><a href="#幫助說明-國際化與在地化" class="headerlink" title="幫助說明(國際化與在地化)"></a>幫助說明(國際化與在地化)</h3><p>在設定上我們會需要撰寫一些幫助說明，輔助使用者瞭解該欄位需填入的內容 (如下圖?按鈕)<br>因此這邊會說明如何<strong>增加幫助說明</strong>與<strong>國際化與在地化方式</strong></p><blockquote><p><strong>這裡提供2種形式</strong></p></blockquote><ol><li>指定檔案 如下方程式碼，在tag內輸入help屬性並指定html檔案 <strong>國際化與在地化</strong>：在檔名後面按規則增加語系 (如<code>help_de.html</code>)<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;$&#123;%title&#125;&quot;</span> <span class="attr">help</span>=<span class="string">&quot;/plugin/myPlugin/help.html&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>以欄位field規則建立 一樣在config.jelly目錄下，我們依照所需的欄位field(這裡以field為name為例)，建立<code>help-name.html</code> <strong>國際化與在地化</strong>：在help-field後按規則增加語系 (如<code>help-name_zh_CN.html</code>)</li></ol><p>關於html內容，我們撰寫html語法的內容即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    Your name.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="預設數值-Default-value"><a href="#預設數值-Default-value" class="headerlink" title="預設數值(Default value)"></a>預設數值(<strong>Default value)</strong></h3><p>如果我們希望輸入框中有預設的數值，只要增加<code>default</code>屬性即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">j:jelly</span> <span class="attr">xmlns:j</span>=<span class="string">&quot;jelly:core&quot;</span> <span class="attr">xmlns:f</span>=<span class="string">&quot;/lib/form&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;$&#123;%Port&#125;&quot;</span> <span class="attr">field</span>=<span class="string">&quot;port&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">f:textbox</span> <span class="attr">default</span>=<span class="string">&quot;80&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">f:entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">j:jelly</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Jelly-中使用變數資料"><a href="#Jelly-中使用變數資料" class="headerlink" title="Jelly 中使用變數資料"></a>Jelly 中使用變數資料</h3><p>在上述中我們知道了Jelly 文件與Java Class有直接關聯，這意味著我們可以調用這些class的方法或是變數資料</p><p>如何使用?</p><ul><li>在Jelly中我們使用”<strong>it</strong>“關鍵字可以調用方法method</li><li>若要定義變數var則使用${insert code here}</li></ul><ol><li>在 <code>java\io\jenkins\plugins\sample\HelloWorldBuilder.java</code> 中我們定義了一個method<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMyString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello Jenkins!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在<code>resources\io\jenkins\plugins\sample\HelloWorldBuilder\config.jelly</code> 中將 getMyString 調用<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">j:jelly</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:j</span>=<span class="string">&quot;jelly:core&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:st</span>=<span class="string">&quot;jelly:stapler&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:d</span>=<span class="string">&quot;jelly:define&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:l</span>=<span class="string">&quot;/lib/layout&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:t</span>=<span class="string">&quot;/lib/hudson&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:f</span>=<span class="string">&quot;/lib/form&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    $&#123;it.myString&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">j:jelly</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>接著若我們執行可以看到’Hello Jenkins!’ 成功出現在UI上啦</li></ol><div class="note info flat"><p>💡 注意：’get’ 被自動從方法名稱中去除，剩下的method name第一個字母是小寫的。<br>建議method name都使用駱駝峰式(CamelCase)命名，以便 Jelly 始終可以找到這些方法。</p><p>變數只要${it.變數名稱}也可是調用</p></div><div class="note info flat"><p>💡 <strong>其他的預定義物件(predefined objects)</strong></p><p>除了it物件，Jenkins 還有定義了以下物件：</p><ul><li>app：the instance of Jenkins (or Hudson)</li><li>instance：Jelly UI 所對應的正在被設定的物件</li><li>descriptor：與 instance 所對應的 Descriptor</li><li>h：an instance of hudson.Functions, with various useful functions</li></ul></div><h3 id="全域環境變數設置"><a href="#全域環境變數設置" class="headerlink" title="全域環境變數設置"></a>全域環境變數設置</h3><p>先前的例子都是以建置元件的設置介紹，若需要全域的環境變數設置也有提供方法</p><p>全域的jelly程式檔名會是global.jelly，而路經在元件目錄底下，也就等同是該元件的全域變數</p><p><code>resources\io\jenkins\plugins\sample\HelloWorldBuilder\global.jelly</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?jelly escape-by-default=&#x27;true&#x27;?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">j:jelly</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:j</span>=<span class="string">&quot;jelly:core&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:st</span>=<span class="string">&quot;jelly:stapler&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:d</span>=<span class="string">&quot;jelly:define&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:l</span>=<span class="string">&quot;/lib/layout&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:t</span>=<span class="string">&quot;/lib/hudson&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:f</span>=<span class="string">&quot;/lib/form&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">f:section</span> <span class="attr">title</span>=<span class="string">&quot;Hello World&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">f:entry</span> <span class="attr">title</span>=<span class="string">&quot;Age&quot;</span> <span class="attr">field</span>=<span class="string">&quot;age&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">description</span>=<span class="string">&quot;i am description&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">f:textbox</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">f:entry</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">f:section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">j:jelly</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/jenkins-plugin-5.png" alt="Untitled"></p><p><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/jenkins-plugin-6.png" alt="Untitled"></p><h2 id="建置報告獨立頁面"><a href="#建置報告獨立頁面" class="headerlink" title="建置報告獨立頁面"></a>建置報告獨立頁面</h2><p>在上述介紹已經了解建置過程可以加入添加元件執行程式，若想要將執行後的報告告訴使用者，除了使用<code>listener.getLogger().println()</code>方法輸出至Console Output頁面，也可以透過實作RunAction2來建構獨立頁面。</p><h3 id="建立HelloWorldAction-java以實作RunAction2"><a href="#建立HelloWorldAction-java以實作RunAction2" class="headerlink" title="建立HelloWorldAction.java以實作RunAction2"></a>建立HelloWorldAction.java以實作RunAction2</h3><p><code>java\io\jenkins\plugins\sample\</code>HelloWorldAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.jenkins.plugins.sample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hudson.model.Run;</span><br><span class="line"><span class="keyword">import</span> io.jenkins.plugins.sample.template.SimpleIssue;</span><br><span class="line"><span class="keyword">import</span> jenkins.model.RunAction2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldAction</span> <span class="keyword">implements</span> <span class="title">RunAction2</span> </span>&#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Run&lt;?,?&gt; run; </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HelloWorldAction</span><span class="params">(String  msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.msg= msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttached</span><span class="params">(Run&lt;?, ?&gt; run)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.run = run; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoad</span><span class="params">(Run&lt;?, ?&gt; run)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.run = run; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Run&lt;?,?&gt; getRun() &#123; </span><br><span class="line">        <span class="keyword">return</span> run;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIconFileName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;document.png&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDisplayName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Greeting&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUrlName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Greeting&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 相關說明：<br>建構子中可放入參數，將Builder的資料傳到Action，這樣獨立頁面的jelly就可以取得需要顯示的資料<br>getIconFileName方法可以設置側邊欄項目圖示<br>getDisplayName方法可以設置側邊欄項目顯示名稱<br>getUrlName方法可以設置獨立頁面的路徑名稱</p></div><h3 id="獨立頁面UI設置"><a href="#獨立頁面UI設置" class="headerlink" title="獨立頁面UI設置"></a>獨立頁面UI設置</h3><p>獨立頁面的話需要設置index.jelly檔案，範例如下：<br><code>resources\io\jenkins\plugins\sample\HelloWorldAction\index.jelly</code></p><p>若要使用變數資料一樣${it.變數名稱}透過這樣的格式就可以調用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?jelly escape-by-<span class="keyword">default</span>=<span class="string">&#x27;true&#x27;</span>?&gt;</span><br><span class="line">&lt;j:jelly xmlns:j=<span class="string">&quot;jelly:core&quot;</span> xmlns:l=<span class="string">&quot;/lib/layout&quot;</span> xmlns:st=<span class="string">&quot;jelly:stapler&quot;</span>&gt;</span><br><span class="line">    &lt;l:layout title=<span class="string">&quot;Greeting&quot;</span>&gt; </span><br><span class="line">        &lt;l:side-panel&gt; </span><br><span class="line">            &lt;st:include page=<span class="string">&quot;sidepanel.jelly&quot;</span> it=<span class="string">&quot;$&#123;it.run&#125;&quot;</span> optional=<span class="string">&quot;true&quot;</span> /&gt; </span><br><span class="line">        &lt;/l:side-panel&gt;</span><br><span class="line">        &lt;l:main-panel&gt; </span><br><span class="line">				     $&#123;it.msg&#125;</span><br><span class="line">        &lt;/l:main-panel&gt;</span><br><span class="line">    &lt;/l:layout&gt;</span><br><span class="line">&lt;/j:jelly&gt;</span><br></pre></td></tr></table></figure><div class="note info flat"><p>💡 1.「layout」是 Jenkins 核心定義的可重用標籤，它提供頁面的基本布局，包括標頭、側邊面板、主內容區域和頁腳。<br>2. 「side-panel」標籤為在側邊面板中顯示<br>3.「main-panel」標籤可以放入獨立頁面中要顯示的內容。</p></div><h3 id="在Builder執行Action以觸發頁面生成"><a href="#在Builder執行Action以觸發頁面生成" class="headerlink" title="在Builder執行Action以觸發頁面生成"></a>在Builder執行Action以觸發頁面生成</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">perform</span><span class="params">(Run&lt;?, ?&gt; run, FilePath workspace, EnvVars env, Launcher launcher, TaskListener listener)</span> <span class="keyword">throws</span> InterruptedException, IOException </span>&#123;</span><br><span class="line">		run.addAction(<span class="keyword">new</span> HelloWorldAction(<span class="string">&quot;Something input&quot;</span>));  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h2><p>雖然篇幅有些長，不過在這篇章節裡，已經可以了解Jenkins Plugin的基本架構以及關聯邏輯，不過除了建置執行之外還有許多擴展點可以研究。</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noopener noreferrer" target="_blank">JunHong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章連結:</span> <span class="post-copyright-info"><a href="https://sp12893678.net/posts/Jenkins%20Plugin%E6%8F%92%E4%BB%B6%E9%96%8B%E7%99%BC%E5%85%A5%E9%96%80/">https://sp12893678.net/posts/Jenkins Plugin插件開發入門/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版權聲明:</span> <span class="post-copyright-info">此文章版權歸JUN-HONG所有，如有轉載，請註明來自原作者</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CI-CD/">CI/CD</a><a class="post-meta__tags" href="/tags/jenkins/">jenkins</a><a class="post-meta__tags" href="/tags/jenkins-plugin/">jenkins plugin</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/%E4%BD%BF%E7%94%A8%20Docker%20Compose%20%E4%B8%80%E6%AC%A1%E5%BB%BA%E7%AB%8B%20Nginx%20%E4%BC%BA%E6%9C%8D%E5%99%A8%20%E8%88%87%20Cerbot(SSL%E8%87%AA%E5%8B%95%E6%86%91%E8%AD%89)/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_ssl-certbot-nginx-dockercompose.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">使用 Docker Compose 一次建立 Nginx 伺服器 與 Cerbot(SSL自動憑證)</div></div></a></div><div class="next-post pull-right"><a href="/posts/%E9%81%8B%E7%94%A8Borg%20%E8%88%87%20Crontab%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%8B%95%E5%8C%96%E6%9C%AC%E5%9C%B0%E8%88%87%E7%95%B0%E5%9C%B0%E5%82%99%E4%BB%BDBackup/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_borg-crontab-automatic-backup.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">運用Borg 與 Crontab建立自動化本地與異地備份Backup</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>相關推薦</span></div><div class="relatedPosts-list"><div><a href="/posts/GitLab 和 Jenkins 建置CICD流程/" title="GitLab + Jenkins 建置CICD流程"><img class="cover" src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_jenkins_CICD.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-14</div><div class="title">GitLab + Jenkins 建置CICD流程</div></div></a></div><div><a href="/posts/運用Docker建置GitLab Server與GitLab CI Runner/" title="運用Docker建置GitLab Server與GitLab CI Runner"><img class="cover" src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_gitlab-server-runner-docker.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-14</div><div class="title">運用Docker建置GitLab Server與GitLab CI Runner</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>評論</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">JunHong</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">標籤</div><div class="length-num">34</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分類</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/SP12893678"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%A6%E4%BD%9C%E9%87%8D%E9%BB%9E"><span class="toc-number">2.</span> <span class="toc-text">實作重點</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%92%B0%E5%A2%83%E6%BA%96%E5%82%99"><span class="toc-number">3.</span> <span class="toc-text">環境準備</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9DJava-JDK-8"><span class="toc-number">3.1.</span> <span class="toc-text">安裝Java JDK 8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9DMaven"><span class="toc-number">3.2.</span> <span class="toc-text">安裝Maven</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A8%AD%E5%AE%9A%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8"><span class="toc-number">3.3.</span> <span class="toc-text">設定環境變數</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%8F%92%E4%BB%B6%E7%AF%84%E6%9C%AC%E5%BB%BA%E7%AB%8B%E5%B0%88%E6%A1%88%E3%80%81%E6%B8%AC%E8%A9%A6%E9%81%8B%E8%A1%8C%E8%88%87%E7%99%BC%E4%BD%88%E6%89%93%E5%8C%85"><span class="toc-number">4.</span> <span class="toc-text">使用插件範本建立專案、測試運行與發佈打包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%A8%A3%E6%9C%AC%E6%8F%92%E4%BB%B6%E5%8E%9F%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%B0%88%E6%A1%88%E7%B5%90%E6%A7%8B"><span class="toc-number">4.1.</span> <span class="toc-text">使用樣本插件原型建立專案結構</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A2%BA%E8%AA%8D%E5%8F%AF%E4%BB%A5%E5%BB%BA%E6%A7%8B%E5%B0%88%E6%A1%88"><span class="toc-number">4.2.</span> <span class="toc-text">確認可以建構專案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%8B%E8%A1%8C%E6%8F%92%E4%BB%B6"><span class="toc-number">4.3.</span> <span class="toc-text">運行插件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%9C%E6%96%BC%E6%B8%AC%E8%A9%A6%E6%99%82%E6%9B%B4%E6%94%B9%E7%A8%8B%E5%BC%8F%E7%A2%BC"><span class="toc-number">4.3.1.</span> <span class="toc-text">關於測試時更改程式碼</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Jenkins%E4%B8%8A%E6%B8%AC%E8%A9%A6%E7%AF%84%E6%9C%AC%E6%8F%92%E4%BB%B6"><span class="toc-number">4.4.</span> <span class="toc-text">在Jenkins上測試範本插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BC%E4%BD%88%E6%89%93%E5%8C%85%E6%8F%92%E4%BB%B6"><span class="toc-number">4.5.</span> <span class="toc-text">發佈打包插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Plugin%E7%B5%90%E6%A7%8B%E8%88%87Java%E8%88%87Jelly%E7%9A%84%E9%97%9C%E8%81%AF%E8%AA%AA%E6%98%8E"><span class="toc-number">5.</span> <span class="toc-text">Plugin結構與Java與Jelly的關聯說明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E7%99%BD%E6%8F%92%E4%BB%B6%E5%B0%88%E6%A1%88%E7%B5%90%E6%A7%8B"><span class="toc-number">5.1.</span> <span class="toc-text">空白插件專案結構</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins-%E9%80%9A%E9%81%8E%E5%9B%BA%E5%AE%9A%E7%9A%84%E5%91%BD%E5%90%8D%E6%96%B9%E5%BC%8F%EF%BC%8C%E4%BE%86%E7%A2%BA%E5%AE%9A%E5%B0%8D%E6%87%89%E7%9A%84%E6%AA%94%E6%A1%88"><span class="toc-number">5.2.</span> <span class="toc-text">Jenkins 通過固定的命名方式，來確定對應的檔案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%92%B0%E5%AF%ABjava%E8%88%87jelly%E6%BA%9D%E9%80%9A%E8%AE%8A%E6%95%B8-%E7%89%A9%E4%BB%B6%E5%B8%B6%E6%9C%89Descriptors"><span class="toc-number">5.3.</span> <span class="toc-text">撰寫java與jelly溝通變數(物件帶有Descriptors)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins-BuildStep%E5%8A%9F%E8%83%BD"><span class="toc-number">6.</span> <span class="toc-text">Jenkins BuildStep功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%96%AE%E9%A9%97%E8%AD%89%E6%A9%9F%E5%88%B6"><span class="toc-number">6.1.</span> <span class="toc-text">表單驗證機制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FormValidation%E6%8F%90%E4%BE%9B%E6%88%91%E5%80%91%E7%B0%A1%E5%96%AE%E6%98%93%E6%87%82%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-number">6.1.1.</span> <span class="toc-text">FormValidation提供我們簡單易懂的功能：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%92%B0%E5%AF%AB%E5%9F%B7%E8%A1%8C%E5%85%A7%E5%AE%B9-amp-%E5%8F%96%E5%BE%97Workspace-%E8%AE%80%E6%AA%94%E3%80%81%E5%AF%AB%E6%AA%94"><span class="toc-number">6.2.</span> <span class="toc-text">撰寫執行內容 &amp; 取得Workspace(讀檔、寫檔)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3Jelly-Tags"><span class="toc-number">7.</span> <span class="toc-text">了解Jelly Tags</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jelly-namespace"><span class="toc-number">7.1.</span> <span class="toc-text">Jelly namespace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E6%96%87%E5%AD%97-%E5%9C%8B%E9%9A%9B%E5%8C%96%E8%88%87%E5%9C%A8%E5%9C%B0%E5%8C%96"><span class="toc-number">7.2.</span> <span class="toc-text">一般文字(國際化與在地化)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%AB%E5%8A%A9%E8%AA%AA%E6%98%8E-%E5%9C%8B%E9%9A%9B%E5%8C%96%E8%88%87%E5%9C%A8%E5%9C%B0%E5%8C%96"><span class="toc-number">7.3.</span> <span class="toc-text">幫助說明(國際化與在地化)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%AD%E6%95%B8%E5%80%BC-Default-value"><span class="toc-number">7.4.</span> <span class="toc-text">預設數值(Default value)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jelly-%E4%B8%AD%E4%BD%BF%E7%94%A8%E8%AE%8A%E6%95%B8%E8%B3%87%E6%96%99"><span class="toc-number">7.5.</span> <span class="toc-text">Jelly 中使用變數資料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%9F%9F%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%A8%AD%E7%BD%AE"><span class="toc-number">7.6.</span> <span class="toc-text">全域環境變數設置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E7%BD%AE%E5%A0%B1%E5%91%8A%E7%8D%A8%E7%AB%8B%E9%A0%81%E9%9D%A2"><span class="toc-number">8.</span> <span class="toc-text">建置報告獨立頁面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8BHelloWorldAction-java%E4%BB%A5%E5%AF%A6%E4%BD%9CRunAction2"><span class="toc-number">8.1.</span> <span class="toc-text">建立HelloWorldAction.java以實作RunAction2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8D%A8%E7%AB%8B%E9%A0%81%E9%9D%A2UI%E8%A8%AD%E7%BD%AE"><span class="toc-number">8.2.</span> <span class="toc-text">獨立頁面UI設置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Builder%E5%9F%B7%E8%A1%8CAction%E4%BB%A5%E8%A7%B8%E7%99%BC%E9%A0%81%E9%9D%A2%E7%94%9F%E6%88%90"><span class="toc-number">8.3.</span> <span class="toc-text">在Builder執行Action以觸發頁面生成</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B5%90%E8%AA%9E"><span class="toc-number">9.</span> <span class="toc-text">結語</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/Traefik+mkcert%20Local%E7%AB%AF%20%E7%B0%A1%E6%98%93TLS%20Domain%E6%A8%A1%E6%93%AC%E7%92%B0%E5%A2%83/" title="Traefik+mkcert：Local端 簡易TLS Domain模擬環境"><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_traefik-mkcert.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Traefik+mkcert：Local端 簡易TLS Domain模擬環境"></a><div class="content"><a class="title" href="/posts/Traefik+mkcert%20Local%E7%AB%AF%20%E7%B0%A1%E6%98%93TLS%20Domain%E6%A8%A1%E6%93%AC%E7%92%B0%E5%A2%83/" title="Traefik+mkcert：Local端 簡易TLS Domain模擬環境">Traefik+mkcert：Local端 簡易TLS Domain模擬環境</a><time datetime="2025-06-17T04:00:00.000Z" title="發表於 2025-06-17 12:00:00">2025-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/Cloudflare%EF%BC%9ADomain%20%E8%A8%97%E7%AE%A1%E4%BE%BF%E6%8D%B7%E6%87%89%E7%94%A8Email%20Routing/" title="Cloudflare：Domain 託管便捷應用 - Email Routing"><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_cloudflare-email-routing.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Cloudflare：Domain 託管便捷應用 - Email Routing"></a><div class="content"><a class="title" href="/posts/Cloudflare%EF%BC%9ADomain%20%E8%A8%97%E7%AE%A1%E4%BE%BF%E6%8D%B7%E6%87%89%E7%94%A8Email%20Routing/" title="Cloudflare：Domain 託管便捷應用 - Email Routing">Cloudflare：Domain 託管便捷應用 - Email Routing</a><time datetime="2025-02-17T04:00:00.000Z" title="發表於 2025-02-17 12:00:00">2025-02-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/%E9%9D%A2%E5%90%91%E5%B0%8E%E5%90%91%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88(AOP)%E6%A6%82%E5%BF%B5%20%E8%88%87%20AspectJ%20%E5%AF%A6%E4%BD%9C/" title="面向導向程式設計(AOP)概念 與 AspectJ 實作"><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_aop.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="面向導向程式設計(AOP)概念 與 AspectJ 實作"></a><div class="content"><a class="title" href="/posts/%E9%9D%A2%E5%90%91%E5%B0%8E%E5%90%91%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88(AOP)%E6%A6%82%E5%BF%B5%20%E8%88%87%20AspectJ%20%E5%AF%A6%E4%BD%9C/" title="面向導向程式設計(AOP)概念 與 AspectJ 實作">面向導向程式設計(AOP)概念 與 AspectJ 實作</a><time datetime="2023-06-17T04:00:00.000Z" title="發表於 2023-06-17 12:00:00">2023-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/%E9%81%8B%E7%94%A8Docker%E5%BB%BA%E7%BD%AEGitLab%20Server%E8%88%87GitLab%20CI%20Runner/" title="運用Docker建置GitLab Server與GitLab CI Runner"><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_gitlab-server-runner-docker.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="運用Docker建置GitLab Server與GitLab CI Runner"></a><div class="content"><a class="title" href="/posts/%E9%81%8B%E7%94%A8Docker%E5%BB%BA%E7%BD%AEGitLab%20Server%E8%88%87GitLab%20CI%20Runner/" title="運用Docker建置GitLab Server與GitLab CI Runner">運用Docker建置GitLab Server與GitLab CI Runner</a><time datetime="2023-06-14T04:00:00.000Z" title="發表於 2023-06-14 12:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/%E9%81%8B%E7%94%A8Borg%20%E8%88%87%20Crontab%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%8B%95%E5%8C%96%E6%9C%AC%E5%9C%B0%E8%88%87%E7%95%B0%E5%9C%B0%E5%82%99%E4%BB%BDBackup/" title="運用Borg 與 Crontab建立自動化本地與異地備份Backup"><img src="https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/banner_borg-crontab-automatic-backup.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="運用Borg 與 Crontab建立自動化本地與異地備份Backup"></a><div class="content"><a class="title" href="/posts/%E9%81%8B%E7%94%A8Borg%20%E8%88%87%20Crontab%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%8B%95%E5%8C%96%E6%9C%AC%E5%9C%B0%E8%88%87%E7%95%B0%E5%9C%B0%E5%82%99%E4%BB%BDBackup/" title="運用Borg 與 Crontab建立自動化本地與異地備份Backup">運用Borg 與 Crontab建立自動化本地與異地備份Backup</a><time datetime="2023-05-16T04:00:00.000Z" title="發表於 2023-05-16 12:00:00">2023-05-16</time></div></div></div></div><div class="card-widget google-ad" id="aside" style="order:999"><div class="item-headline"><i></i><span></span></div><div class="item-content"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8883435840385596" data-ad-slot="9215689748" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></div></main><footer id="footer" style="background-image:url(https://cdn.jsdelivr.net/gh/sp12893678/blog@gh-pages/img/background2.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By JunHong</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/" rel="external nofollow noopener noreferrer"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="部落格框架為 Hexo" alt="HEXO"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/" rel="external nofollow noopener noreferrer"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主題採用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://www.jsdelivr.com/" rel="external nofollow noopener noreferrer"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="網站使用 Jsdelivr 為靜態資源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/" rel="external nofollow noopener noreferrer"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="網站專案由github管理" alt="GitHub"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站採用知識共享署名-非商業性使用-相同方式共享4.0國際許可協議進行許可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="淺色和深色模式轉換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直達評論"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到頂部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜尋</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource(){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css",document.getElementsByTagName("head")[0].appendChild(e)}function loadGitalk(){function e(){new Gitalk(Object.assign({clientID:"efa467f2e4c4bf8b9b95",clientSecret:"b5fd9de6470980da4a33ac2cbefd990125c9a945",repo:"blog",owner:"SP12893678",admin:["SP12893678"],id:"0dc8e60d22e3fef49779dae402180f57",language:"zh-TW",perPage:10,distractionFreeMode:!1,pagerDirection:"last",createIssueManually:!1,updateCountCallback:commentCount},null)).render("gitalk-container")}"function"==typeof Gitalk?e():(addGitalkSource(),getScript("https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js").then(e))}function commentCount(e){let t=document.querySelector("#post-meta .gitalk-comment-count");t&&(t.innerHTML=e)}{function loadOtherComment(){loadGitalk()}btf.loadComment(document.getElementById("gitalk-container"),loadGitalk)}</script></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="/js/bubble.js"></script><div class="app-refresh" id="app-refresh"><div class="app-refresh-wrap"><label>✨ 網站已更新最新版本 👉</label> <a href="javascript:void(0)" onclick="location.reload()">點擊刷新</a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"點擊刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>